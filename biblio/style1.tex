\chapter{Modifier les styles bibliographiques (1)}

	\begin{prealable}
	
	Vous savez désormais utiliser les commandes de citations. Toutefois, vous pourriez souhaiter modifier la manière dont les citations s'affichent :  changer l'ordre des champs, les séparateurs, les textes du type \forme{dans}.
	
	Ces deux chapitres vous indiquerez les principes généraux pour le faire. Étant donné l'ampleur du sujet, deux chapitres ne sont pas de trop. Par ailleurs, ils n'ont pas pour vocation de tout présenter sur le sujet, mais simplement les principes de base. On se reportera au manuel de \package{BibLaTeX} pour aller plus loin.
	
	Le premier de ce chapitre vous présentera les techniques les plus simples, celle qui ne nécessite pas de fouiller le styles bibliographiques standards. 
	
	
	\end{prealable}
	
	
\section{Séparateurs d'unité de sens}
	
Prenons un problème courant. Vous aurez constaté que, par défaut, les différents champs d'une référence bibliographique sont séparés par des points.

	On obtient par exemple :
	
	\renewcommand{\newunitpunct}[0]{\adddot\addspace} 
	
	\begin{quotation}
	\cite{Urner1952}
	\end{quotation}
	
alors que le règles françaises voudraient que l'on ait :
	
\renewcommand{\newunitpunct}[0]{\addcomma\addspace}
	
	\begin{quotation}
	\cite{Urner1952}
	\end{quotation}
	
À l'intérieur d'une référence bibliographique, BibLaTex distingue des unités de sens\footnote{À vrai dire il existe des unités plus vastes, appelés blocs. Mais ces unités servent pour des réglages avancés de l'affichage de la bibliographie finale.}. Ici : l'auteur, le titre, l'adresse, l'éditeur, l'année. 

	Ces unités sont séparés par des signes de ponctuations. Ces séparateurs sont définis par la commande \commande{newunitpunct}.
	
	Il suffit donc de redéfinir la commande. Pour cela il suffit de mettre dans le préambule\footnote{Cela n'est pas obligé, mais c'est une bonne méthodologie de mettre l'ensemble des commandes de personnalisations de styles dans le préambule. Nous conseillons de mettre toutes les commandes de personnalisation des styles bibliographiques dans un seul fichier, appelé dans le préambule.} : 
		
	\begin{minted}{latex}
\renewcommand{\newunitpunct}[0]{,}
	\end{minted}
	
	Cette solution semble fonctionner. Mais elle pose un problème : les styles définissent des unités de sens sans se poser la question de savoir si ces unités sont vides ou pas.
	
	Prenons l'entrée suivante :
	
		
	\inputminted{exemples/biblio/style1/afrique.bib}
	
	On obtiendra le résultat suivant :
	
	\begin{quotation}
		\cite{BrefHippone}
	\end{quotation}
	
	La virgule entre les deux points et \emph{Concilia Africae} s'explique parce qu'une unité a été créée, unité qui doit contenir normalement la valeur du champ \champ{Bookauthor}.
	
	Pour contourner ce problème, il ne faut pas mettre directement dans la définition de la commande \commande{newunitpunct} les signes de ponctuation. Il faut utiliser les commandes de ponctuation\footcite[Listées dans]{biblatex_ponctuation}. En effet, ces commandes afficheront la ponctuation uniquement si l'unité qui précède a bien un contenu\footnote{Par ailleurs, elle suppriment les espaces multiples qui précédent.}. \renvoi{commandesponctuation}
	
	Il faut donc mettre dans notre cas :
	
	\begin{minted}{latex}
\renewcommand{\newunitpunct}[0]{\addcomma\addspace}
	\end{minted}
	
	\begin{anedocte}
		Nous n'avons par parlé jusqu'à présent de la commande \commande{renewcommand}. Celle-ci est identique à la commande \commande{newcommand} à la différence qu'elle permet de redéfinir une commande déjà existante.
	\end{anedocte}
	
	
\subsection{Une séparateur spécifique à deux unités}
	
	On pourrait vouloir qu'entre deux unités spécifiques, par exemple entre le titre et le sous titre, le séparateur ne soit pas le même qu'entre les autres unités.	Vous aurez sans doute constaté que c'est d'ailleurs le cas pour le style verbose : l'adresse et l'édition sont séparés par des deux-points.
	
	Deux cas existent :
		\begin{enumerate}
			\item \package{BibLaTeX} a prévu une commande spécifique pour notre type d'unité. C'est le cas pour le séparateur avant le sous titre\footcite[Ces commandes sont peu nombreuse : on les trouvera dans]{biblatex_hooks}. Il suffit dans ce cas de redéfinir la commande. Par exemple nous souhaitons avoir des deux-points entre le titre et le sous titre. Il nous suffit de faire :
			\begin{minted}{latex}
\renewcommand{\subtitlepunct}[0]{\addspace\addcolon\addspace}
			\end{minted}
			
			\item \package{BibLaTeX} n'a pas prévu de commande spécifique pour notre type d'unité. Dans ce cas, le problème est plus complexe et nécessite des notions que nous n'avons pas encore abordées. C'est pourquoi nous renvoyons au prochain chapitre.\renvoi{unitepersonalisee}
		\end{enumerate}
		
\section{Séparateur de références multiples}\label{multicitedelim}

Lorsque nous utilisons une commande de citation multiple\renvoi{citemultiple}, les séparateurs par défaut sont des points-virgules :

\begin{minted}{latex}
\autocites{Saxer1980}{Junod1992}
\end{minted}

\begin{quotation}
\cites{Saxer1980}{Junod1992}
\end{quotation}

On peut là aussi modifier le séparateur en rédefinissant la commande \commande{multicitedelim}. Par exemple pour avoir une virgule :

\begin{minted}{latex}
\renewcommand{\multicitedelim}[0]{\addcomma\addspace}
\end{minted}

\section{Styles de certains blocs}

La ponctuation n'est pas le seul point où \package{BibLaTeX} propose des points d'entrés pour des modifications spécifiques. Certaines parties des références bibliographiques disposent également de la possibilité d'avoir des réglages grâce à des commande spécifiques\footcite{biblatex_hooks}. Prenons par exemple la particule d'un auteur.
	
	\begin{quotation}
	\cite{BeauvoirSexe}
	\end{quotation}
	
	\renewcommand{\mkbibnameprefix}[1]{\parentext{#1}}
	
Il est parfois d'usage de mettre la particule entre parenthèse. Pour ce faire, il suffit de redéfinir la commande \commande{mkbibnameprefix}. Cette commande prend un argument, qui est la particule. Ainsi pour la mettre automatiquement entre parenthèse, il suffit d'écrire.
	
	\begin{minted}{latex}
\renewcommand{\mkbibnameprefix}[1]{(#1)}
	\end{minted}
	
Voire pour être encore plus correct :
	
	\begin{minted}{latex}
\renewcommand{\mkbibnameprefix}[1]{\parentext{#1}}
	\end{minted}

La commande \commande{parentext} mettant entre parenthèse un texte passé en argument. On obtient le résultat souhaité : 

	\begin{quotation}
	\cite{BeauvoirSexe}
	\end{quotation}

\section{Chaînes de langues}
	
	Les chaînes de langues sont ces morceaux de textes figés mais qui dépendent de la langue. Prenons une entrée de type article, lorsque nous la citons, nous obtenons.
	
	 
	 
	\begin{quotation}
		\cite{Junod1992}
	\end{quotation}
	
	La chaîne \forme{dans} sépare le titre de l'article et le nom de la revue. Si nous rédigions en anglais, nous aurions \forme{in} à la place.  
	
	Il peut justement nous arriver de vouloir changer ces chaînes de langues, par exemple pour avoir la forme \forme{in}, qui est un terme latin souvent utilisé dans les bibliographies. Une chaîne de langues associe à une clef invariable une valeur qui change selon la langue.
	
	Les styles bibliographiques possèdent des chaînes de langues par défaut, qu'il est possible de remplacer au cas par cas. Pour ce faire, ils nous faut toutefois connaître les clefs. Il nous faut donc ouvrir le fichier de langue \fichier{french.lbx}. Pour repérer ce fichier, voir notre explication en annexe.\renvoi{fichierdefaut}.
	
	Une fois ce fichier ouvert, repérons la ligne qui commence par
	
	\begin{minted}{latex}
\DeclareBibliographyStrings{
	\end{minted}
	
	Cette ligne est suivie d'autres lignes sous la forme :
	
	\begin{minted}{latex}
clef	= {{chaîne longue}{chaîne courte}}|
	\end{minted}
	
	\begin{anedocte}
	Chaque chaîne de langue est disponible en version longue ou courte. On peut passer une option lors de l'appel du package \package{biblatex} pour décider d'utiliser les versions longues.
	
	\begin{minted}{latex}
\usepackage[abbreviate=false]{biblatex}
	\end{minted}
	
	 Toutefois quand on redéfini une chaîne de langue, on ne lui accorde qu'une seule version.
	
		

	\end{anedocte}
	Il nous faut donc repérer la clef correspondante à notre chaîne \enquote{dans}. Très rapidement nous trouvons qu'il s'agit de la chaine \verb|in|.
	
	Une fois  notre clef repérée, il est facile de lui attribuer une nouvelle valeur\footnote{Cette valeur sera utilisée que l'on choisisse le mode abrégé ou non.}, grâce à la commande \commande{DefineBibliographyStrings{lang}{chaînes}}
	
	\begin{minted}{latex}
\DefineBibliographyStrings{french}{%
	in = {\emph{in}}%
}
	\end{minted}
	
	Constatons qu'on peut utiliser dans une chaîne de langue des commandes \LaTeX. Si notre chaîne contient des signes de ponctuations, il faut utiliser les commandes de ponctuation mentionnées plus haut.Less \% à la fin de chaque ligne, sont ici pour éviter les espacement intempestifs.\renvoi{commandepourcent}
	
	Si nous souhaitons redéfinir plusieurs chaînes de langue, il faut séparer chaque définition par une virgule :
	
	\begin{minted}{latex}
\DefineBibliographyStrings{french}{%
clef1 = {valeur1},%
clef2 = {valeur2},%
clefN = {valeurN}%
}
	\end{minted}
	
\subsection{Introduction au tests conditionnels}\label{opcit}

Nous allons maintenant prendre un peu d'anticipation sur le prochaine chapitre.
Vous avez certainement constaté que les styles de la famille \forme{verbose-trad} utilisent des abréviations latines comme \emph{op. cit.}.
Ces abréviations sont les abréviations universitaires courantes. Toutefois en ce qui concerne l'abréviation \emph{op. cit.} cit.} l'utilise indistinctement pour tout les types d'entrées, y compris pour les entrées de type @article, alors même qu'on pourrait s'attendre à une abréviation de type \emph{art. cit.}.

Pour résoudre ce problème, il suffit de redéfinir la chaîne de langue qui définit \emph{op. cit.} cit.}, en lui attribuant une valeur différente selon le type d'entrée.  On va donc utiliser l'un des nombreux tests conditionnels disponibles dans \empg{BibLaTeX}. Il s'agit de la commande :

\begin{minted}{latex}
\iffieldequalstr{champ}{texte}{sioui}{sinon}
\end{minted}

Cette commande ne peut s'utiliser que dans certaines parties d'un fichier \LaTeX : dans les commandes de définitions de styles bibliographiques, y compris dans celles de définition d'un chaîne de langue. 
Elle vérifie que le champ \argument{champ}	de l'entrée bibliographique citée correspond à l'argument \argument{texte} : si c'est le cas, elle retourne l'argument \argument{sioui}, et sinon elle retourne l'argument \argument{sinon}.

Ici nous allons tester le pseudo-champ\footnote{\forme{Pseudo} car il ne se situe pas réellement comme un champ dans l'entrée bibliographique.} \champ{entrytype}, qui correspond au type d'entrée sans le @. Nous allons donc vérifier s'il s'agit d'une entrée de type article : si c'est le cas nous donnerons à la chaîne de langue la valeur  \forme{art. cit.},  dans le cas contraire nous donnerons la valeur \emph{op. cit.} cit.}.

Ce qui donne : 

\begin{minted}{latex}
\DefineBibliographyStrings{french}{%
	opcit = \iffieldequalstr{entrytype}{article}%
	{art\adddotspacecit\adddot}%
	{op\adddotspacecit\adddot}%
}
\end{minted}

On remarquera l'utilisation des commandes de ponctuations, comme signalé plus haut.\renvoi{commandeponctuation}


	