\chapter{Sommaires et tables des matières}\label{toc}

\begin{prealable}
Dans ce chapitre nous verrons comment générer un sommaire ou table des matière. Nous en profiterons pour étudier la manière de modifier les chaînes de langues de (quoi d'ailleurs ? à voir) ainsi que la notion de compteur en \LaTeX{}. Nous indiquerons également les bases de la configuration du package \package{hyperref}, qui permet, entre autre, de proposer des signets dans le PDF généré.
\end{prealable}

\section{Une table simple}

La manière la plus simple de faire une table des matières est d'utiliser la commande :

\begin{minted}{latex}
\tableofcontents
\end{minted}

Pour que \LaTeX{} puisse afficher cette table des matières, il est nécessaire de compiler deux fois : lors de la première compilation, \LaTeX{} stockera le contenu de la table des matières dans un fichier \ext{toc}, lors de la seconde compilation, il se servira de ce fichier pour créer la table des matières. En règle générale, cette double compilation n'est guère gênante, puisqu'elle déjà nécessaire lors de l'utilisation d'une bibliographie.\renvoi{3compil}

\begin{attention}
La table des matières prend elle même un certain volume. Par conséquent si votre table des matière se trouve en début d'ouvrage --- il serait alors plus juste de l'appeler \forme{sommaire} ---, elle va décaler la pagination. C'est pourquoi il faut parfois compiler trois fois :

\begin{enumerate}
\item La première fois, \LaTeX{} va stocker les informations dans le fichier \ext{toc}.
\item La seconde fois, la table des matières va s'afficher, décalant la numérotation des pages. \LaTeX{} va stocker les nouveaux numéros de pages  dans le fichier \ext{toc}.
\item La troisième fois, la table des matières avec les bon numéros de page  va s'afficher. Comme sa taille n'est pas différente de la précédente, il n'y aura pas de décalage des numéros.
\end{enumerate}

\end{attention}

\section[Choix de la profondeur]{Choisir la profondeur de la table des matières : la notion de compteur}\label{tocdepth}

Par défaut la commande \commande{tableofcontents} affiche tout les niveaux de titres, depuis \commande{part} jusqu'au \commande{subparagraph}.\renvoi{niveautitre}. Il est possible de restreindre la profondeur, ou au contraire de l'étendre. Pour ce faire, il suffit de redéfinir un compteur \LaTeX{} : \compteur{tocdepth}.

Un compteur, en \LaTeX{}, est un nombre entier stocké dans la mémoire vive de l'ordinateur. Un compteur peut être appelé à certains endroits par \LaTeX{}. Il peut également être modifié par \LaTeX{}. Typiquement, un compteur est associé à un élément numéroté. Il existe par exemple un compteur \compteur{page} correspondant au numéro de la page, incrémenté par \LaTeX{} à chaque changement de page et utilisé pour afficher le numéro de page. \revision{Un peut technique non ?}

Dans notre cas, le compteur \compteur{tocdepth} n'est pas modifié par \LaTeX{}. En revanche il sert lors de l'affichage de la table des matières. Chaque niveau de titre possède un numéro. \renvoi{numeroniveau}. La commande \commande{tableofcontents} affiche les niveaux de titres dont le numéro est inférieur ou égale à la valeur du compteur \compteur{tocdepth}.

Le niveau \commande{subsubsection} a comme numéro 3. Pour afficher dans la table des matières tous les niveaux de titres jusqu'au niveau \commande{subsubsection} inclus, il faut donc affecter la valeur 3 à  \compteur{tocdepth}. Pour ce faire il faut utiliser la commande \commande{setcounter} :

\begin{minted}{latex}
\setcounter{tocdepth}{3}
\tableofcontents
\end{minted}

\section[Table des matières ou sommaire ?]{Table des matières ou sommaire ? les chaînes de langues de polyglossia}

\revision{peut être à mettre dans un chapitre à part ?}
En France, une table des matière se situe en fin d'ouvrage, tandis qu'un sommaire se situe en début d'ouvrage. Par défaut la commande \commande{tableofcontents} indique que nous avons affaire à une  \enquote{table des matières} et non pas à un \commande{sommaire}. Comment faire ? Il suffit de redéfinir les chaînes de langues. 

Nous avons déjà vu la notion de chaîne de langues pour la bibliographie.\renvoi{i18n} Il s'agit ici  d'une idée similaire, mais pour le package \package{polyglossia}. La syntaxe est toutefois différentes. Comme pour les toutes les chaînes de langues, il faut commencer par découvrir quelle est la chaîne à modifier. Cela se passe dans le fichier \fichier{french.ldf}. Vous pouvez repérer une ligne contenant \verb|\def\captionsfrench{%|. 
Cette ligne est suivie d'autres lignes sous la forme : \verb|\def\chaine{Valeur}%|. Et ce jusqu'à une accolade fermante.

Pour notre cas, on peut aisément repérer la ligne contenant \verb|\def\contentsname{Table des matières}%|.
Notre chaîne de langue est donc \forme|contentsname|.

Pour  redéfinir une chaîne de langue, il suffit d'écrire, de préférence dans le préambule :

\begin{minted}{latex}
\gappto\captionsfrench{\renewcommand{\chaine}{Valeur}}
\end{minted}

Dans le cas présent, cela donne :

\begin{minted}{latex}
\gappto\captionsfrench{\renewcommand{\contentsname}{Sommaire}}
\end{minted}



\begin{anedocte}
La commande \commande{def} permet de créer des nouvelles commandes. Toutefois à la différence de la commande \commande{newcommand}, les commandes ainsi créées appartiennent à \TeX{} et non pas à \LaTeX{}.\renvoi{TeXLaTeX}

Définir des commandes en \TeX{} par rapport à les définir en \LaTeX{} permet plus de souplesse. Mais cela demande plus de maîtrise technique pour éviter divers problèmes (comme des erreurs de compilation.). C'est pourquoi nous n'en parlons pas dans ce livre, sauf précisément ici.

Les commandes \TeX{} peuvent contenir des \enquote{sous commandes}. Ici par exemple, la commande \commande{captionfrench} contient la sous commande \commande{contentsname}. Nous utilisons la commande \TeX{} \commande{gappto} pour \enquote{injecter} une sous-commande dans une commande déjà définir.
\end{anedocte}

\section{Table des figures et tables des tableaux}\label{tablefigure}

En plus de la table des matières, \LaTeX{} permet d'afficher une table des tableaux et une table des figures. Il est nécessaire pour que ces tables soit constituées que les tableaux et figures soient des flottants avec une légende. \renvoi{legende}

Pour la table des tableaux, il faut utiliser la commande \commande{listoftables} et pour la table des figures la commande \commande{listoffigures}.


%
%\section{Plusieurs tables des matières}
%
%La commande \commande{tableofcontents} ne fonctionne qu'une seule fois dans un document \LaTeX{}. Comment faire si on souhaite avoir un sommaire et une table des matières, ou bien des tables des matières par partie ?
%
%La méthode la plus simple consiste à  utiliser le package \package{minitoc}.
%
% En suspend, en attendant que je comprennent toutes les subtilités.
